# PO 자동화 서비스 구현 계획서

## 📋 프로젝트 개요

### 목표
이메일로 수신되는 PO(Purchase Order, 구매 주문서)를 자동으로 분류하고 SAP 시스템에 자동 등록하는 통합 서비스 구축

### 핵심 기능
- 이메일 첨부파일 자동 분류
- PO 문서 자동 인식 및 데이터 추출
- SAP 시스템 자동 등록
- 사용자 검증 인터페이스

---

## 🔄 단계별 구현 계획

### STEP 1: 학습 데이터 구축 단계
> **목표**: PO 분류 모델 학습을 위한 데이터셋 구축 및 라벨링 시스템 구현

#### 1.1 파일 업로드 및 분류
- **기능 요구사항**
  - 웹 인터페이스를 통한 파일 업로드 (이메일 첨부파일)
  - 업로드된 파일의 PO 여부 수동 분류
  - 분류 결과를 학습 데이터로 저장

- **구현 상세**
  ```
  [업로드 화면]
  - 드래그 앤 드롭 파일 업로드
  - 다중 파일 동시 업로드 지원
  - 파일 타입: PDF, 이미지, Excel 등
  
  [분류 인터페이스]
  - 각 파일별 PO/Non-PO 체크박스
  - 파일 미리보기 기능
  - 분류 이유 메모 기능 (선택사항)
  ```

#### 1.2 PO 문서 처리
- **PDF 변환 프로세스**
  - PDF → PNG 이미지 분할
  - 페이지별 이미지 저장
  - 이미지 품질 최적화

- **라벨링 시스템**
  - 바운딩 박스 기반 영역 지정
  - 라벨 타입 정의
    - PO 번호
    - 공급업체 정보
    - 품목 리스트
    - 금액 정보
    - 납기일
    - 기타 주요 필드
  
- **데이터 저장**
  - 라벨링 데이터 JSON 형식 저장
  - 데이터베이스 스키마
    ```sql
    -- 예시 테이블 구조
    CREATE TABLE po_labels (
        id INT PRIMARY KEY,
        file_id VARCHAR(255),
        page_number INT,
        label_type VARCHAR(50),
        coordinates JSON,
        extracted_text TEXT,
        confidence_score FLOAT,
        created_by VARCHAR(100),
        created_at TIMESTAMP
    );
    ```

#### 1.3 학습 데이터 관리
- **데이터 버전 관리**
  - 라벨링 히스토리 추적
  - 수정 이력 관리
  - 데이터셋 버전별 저장

---

### STEP 2: 자동화 운영 단계
> **목표**: 학습된 모델을 활용한 실시간 PO 처리 자동화

#### 2.1 이메일 연동
- **이메일 시스템 통합**
  - IMAP/POP3 프로토콜 연동
  - 실시간 메일 모니터링
  - 첨부파일 자동 추출

- **자동 분류 프로세스**
  ```
  이메일 수신 → 첨부파일 추출 → PO 분류 모델 실행 → 분류 결과 저장
  ```

#### 2.2 자동 라벨링 및 데이터 추출
- **OCR 처리**
  - 학습된 모델 기반 자동 라벨링
  - 주요 필드 자동 추출
  - 신뢰도 점수 계산

- **데이터 검증**
  - 필수 필드 완성도 체크
  - 형식 유효성 검증
  - 중복 PO 확인

#### 2.3 사용자 검토 인터페이스
- **대시보드 구성**
  ```
  [수신 현황]
  - 일별 수신 파일 건수
  - 파일명 리스트
  - 발신자 정보
  - 메일 제목/내용
  
  [PO 확인 현황]
  - 자동 분류된 PO 건수
  - PO별 상세 정보
  - 신뢰도 점수
  - 검토 상태
  ```

- **검토 워크플로우**
  1. 자동 분류 결과 확인
  2. 미확인 PO 수동 검토
  3. 오분류 수정 및 재학습
  4. 최종 승인 처리

#### 2.4 SAP 연동
- **자동 등록 프로세스**
  - SAP API/RFC 연동
  - 필드 매핑 규칙 정의
  - 자동 등록 실행
  - 등록 결과 피드백

#### 2.5 히스토리 관리
- **일별 처리 현황**
  - 처리 일시
  - PO 번호
  - 공급업체
  - 금액
  - 처리 상태
  - 담당자

- **통계 리포트**
  - 월별 처리 건수
  - 자동화 성공률
  - 평균 처리 시간
  - 오류 발생 현황

---

### STEP 3: 최적화 운영 단계
> **목표**: 완전 자동화된 시스템 운영 및 모니터링

#### 3.1 사용자 역할
- **모니터링 중심 운영**
  - 통계 대시보드 확인
  - 예외 케이스만 검토
  - 시스템 성능 모니터링

#### 3.2 통계 및 분석
- **실시간 대시보드**
  ```
  [처리 통계]
  - 자동화율: 95% 이상 목표
  - 정확도: 99% 이상 목표
  - 평균 처리 시간: 30초 이내
  
  [품질 지표]
  - 오분류율
  - 재작업율
  - 사용자 개입 빈도
  ```

- **트렌드 분석**
  - 공급업체별 PO 패턴
  - 시간대별 수신 현황
  - 오류 패턴 분석

#### 3.3 예외 처리
- **알림 시스템**
  - 신뢰도 낮은 케이스 알림
  - 신규 패턴 감지 알림
  - 시스템 오류 알림

- **에스컬레이션**
  - 자동 처리 실패 케이스
  - 수동 개입 필요 상황
  - 긴급 처리 요청

---

## 🏗️ 기술 아키텍처

### 시스템 구성도
```
┌─────────────┐     ┌──────────────┐     ┌─────────────┐
│   이메일    │────▶│   웹 서버    │────▶│     SAP     │
│   서버      │     │  (Flask/     │     │   시스템    │
└─────────────┘     │   FastAPI)   │     └─────────────┘
                    └──────────────┘
                           │
                    ┌──────▼──────┐
                    │   데이터베이스│
                    │  (PostgreSQL)│
                    └──────────────┘
                           │
                    ┌──────▼──────┐
                    │   ML 모델    │
                    │  (TensorFlow)│
                    └──────────────┘
```

### 핵심 기술 스택
- **백엔드**: Python (Flask/FastAPI)
- **프론트엔드**: React/Vue.js
- **데이터베이스**: PostgreSQL
- **ML/OCR**: TensorFlow, Tesseract OCR
- **이메일 연동**: IMAP/POP3
- **SAP 연동**: SAP RFC/REST API

---

## 📊 예상 효과

### 정량적 효과
- **처리 시간 단축**: 수동 10분 → 자동 30초 (95% 감소)
- **정확도 향상**: 수동 90% → 자동 99% (오류율 90% 감소)
- **처리량 증가**: 일 100건 → 일 1,000건 (10배 증가)

### 정성적 효과
- 직원 업무 부담 감소
- 실시간 처리로 업무 지연 방지
- 데이터 일관성 향상
- 감사 추적 용이성 증대

---

## 🚀 구현 로드맵

### Phase 1: 기반 구축 (2개월)
- [ ] 웹 인터페이스 개발
- [ ] 파일 업로드/분류 시스템
- [ ] 라벨링 도구 구현
- [ ] 데이터베이스 설계

### Phase 2: 학습 및 자동화 (2개월)
- [ ] ML 모델 학습
- [ ] 이메일 연동 개발
- [ ] 자동 분류/라벨링 구현
- [ ] 검토 인터페이스 개발

### Phase 3: SAP 연동 (1개월)
- [ ] SAP 인터페이스 개발
- [ ] 필드 매핑 구현
- [ ] 자동 등록 프로세스
- [ ] 오류 처리 로직

### Phase 4: 최적화 (1개월)
- [ ] 성능 튜닝
- [ ] 모니터링 대시보드
- [ ] 알림 시스템
- [ ] 사용자 교육

---

## ⚠️ 주요 고려사항

### 보안
- 이메일 접근 권한 관리
- PO 데이터 암호화
- SAP 연동 보안
- 사용자 인증/권한

### 확장성
- 다국어 PO 지원
- 다양한 PO 형식 대응
- 시스템 부하 분산
- 스토리지 관리

### 안정성
- 장애 복구 계획
- 데이터 백업 전략
- 트랜잭션 관리
- 로그 관리

---

## 📝 참고사항

- 본 문서는 초기 계획 단계의 내용으로, 실제 구현 시 세부사항이 변경될 수 있습니다.
- 각 단계별 상세 기술 명세는 별도 문서로 작성 예정입니다.
- SAP 연동 부분은 고객사 SAP 환경에 따라 커스터마이징이 필요합니다.

---

*문서 작성일: 2025-09-02*
*버전: 1.0.0*